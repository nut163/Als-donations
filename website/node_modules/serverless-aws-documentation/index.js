'use strict';

const AWS = require('aws-sdk');
const serverless = require('serverless');

class ServerlessAWSDocumentation {
  constructor(serverless, options) {
    this.serverless = serverless;
    this.options = options;
    this.provider = this.serverless.getProvider('aws');

    this.hooks = {
      'before:deploy:deploy': this.beforeDeploy.bind(this),
    };
  }

  beforeDeploy() {
    this.serverless.cli.log('Generating AWS documentation...');
    const docClient = new AWS.DynamoDB.DocumentClient();
    const params = {
      TableName: 'ALS_Prevention',
      Item: {
        'ID': 1,
        'Info': 'This is a non-profit organization focused on ALS prevention.'
      }
    };

    docClient.put(params, function(err, data) {
      if (err) {
        this.serverless.cli.log('Error generating documentation', err);
      } else {
        this.serverless.cli.log('Successfully generated AWS documentation');
      }
    });
  }
}

module.exports = ServerlessAWSDocumentation;